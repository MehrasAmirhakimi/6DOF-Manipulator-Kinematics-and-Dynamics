% Craig DH convension
a = a1^4 - a2^4*cos(alpha1)^2 - a3^4*cos(alpha1)^2 - d2^4*cos(alpha1)^2 - d3^4*cos(alpha1)^2 - d4^4*cos(alpha1)^2 - r^2*cos(alpha1)^2 - 4*a2*a3^3 - 4*a2^3*a3 - 2*a1^2*r - 2*a2^2*r - 2*a3^2*r - 2*d2^2*r - 2*d3^2*r - 2*d4^2*r - a1^4*cos(alpha1)^2 + a2^4 + a3^4 + d2^4 + d3^4 + d4^4 + r^2 - 2*a1^2*a2^2 - 2*a1^2*a3^2 + 6*a2^2*a3^2 + 2*a1^2*d2^2 - 2*a1^2*d3^2 + 2*a2^2*d2^2 + 2*a1^2*d4^2 + 2*a2^2*d3^2 + 2*a3^2*d2^2 + 2*a2^2*d4^2 + 2*a3^2*d3^2 + 2*a3^2*d4^2 + 2*d2^2*d3^2 + 6*d2^2*d4^2 + 2*d3^2*d4^2 + 4*a1^2*z^2 + 2*a1^2*a2^2*cos(alpha1)^2 + 2*a1^2*a3^2*cos(alpha1)^2 - 6*a2^2*a3^2*cos(alpha1)^2 + 2*a1^2*d2^2*cos(alpha1)^2 + 2*a1^2*d3^2*cos(alpha1)^2 - 2*a2^2*d2^2*cos(alpha1)^2 + 4*a1^2*d3^2*cos(alpha2)^2 + 2*a1^2*d4^2*cos(alpha1)^2 - 2*a2^2*d3^2*cos(alpha1)^2 - 2*a3^2*d2^2*cos(alpha1)^2 - 4*a1^2*d4^2*cos(alpha2)^2 - 2*a2^2*d4^2*cos(alpha1)^2 - 2*a3^2*d3^2*cos(alpha1)^2 - 4*a1^2*d4^2*cos(alpha3)^2 - 2*a3^2*d4^2*cos(alpha1)^2 - 2*d2^2*d3^2*cos(alpha1)^2 + 4*d2^2*d3^2*cos(alpha2)^2 - 6*d2^2*d4^2*cos(alpha1)^2 - 4*d2^2*d4^2*cos(alpha2)^2 - 2*d3^2*d4^2*cos(alpha1)^2 - 4*d2^2*d4^2*cos(alpha3)^2 + 4*d3^2*d4^2*cos(alpha3)^2 + 4*d2*d3^3*cos(alpha2) + 4*d2^3*d3*cos(alpha2) + 4*d3*d4^3*cos(alpha3) + 4*d3^3*d4*cos(alpha3) + 4*a2*a3*r + 4*a2*a3^3*cos(alpha1)^2 + 4*a2^3*a3*cos(alpha1)^2 + 2*a1^2*r*cos(alpha1)^2 + 2*a2^2*r*cos(alpha1)^2 + 2*a3^2*r*cos(alpha1)^2 + 2*d2^2*r*cos(alpha1)^2 + 2*d3^2*r*cos(alpha1)^2 + 2*d4^2*r*cos(alpha1)^2 + 4*a1^2*a2*a3 - 4*a2*a3*d2^2 - 4*a2*a3*d3^2 - 4*a2*a3*d4^2 - 4*a1^2*a2*a3*cos(alpha1)^2 + 4*a2*a3*d2^2*cos(alpha1)^2 + 4*a2*a3*d3^2*cos(alpha1)^2 + 4*a2*a3*d4^2*cos(alpha1)^2 + 4*d2*d4^3*cos(alpha2)*cos(alpha3) + 4*d2^3*d4*cos(alpha2)*cos(alpha3) + 8*a1^2*d4^2*cos(alpha2)^2*cos(alpha3)^2 - 4*d2^2*d3^2*cos(alpha1)^2*cos(alpha2)^2 + 4*d2^2*d4^2*cos(alpha1)^2*cos(alpha2)^2 + 4*d2^2*d4^2*cos(alpha1)^2*cos(alpha3)^2 + 8*d2^2*d4^2*cos(alpha2)^2*cos(alpha3)^2 - 4*d3^2*d4^2*cos(alpha1)^2*cos(alpha3)^2 + 4*d2*d4^3*sin(alpha2)*sin(alpha3) + 4*d2^3*d4*sin(alpha2)*sin(alpha3) - 4*d2*d3*r*cos(alpha2) - 4*d3*d4*r*cos(alpha3) - 4*d2*d3^3*cos(alpha1)^2*cos(alpha2) - 4*d2^3*d3*cos(alpha1)^2*cos(alpha2) - 4*d3*d4^3*cos(alpha1)^2*cos(alpha3) - 4*d3^3*d4*cos(alpha1)^2*cos(alpha3) + 4*a1^2*d2*d3*cos(alpha2) + 4*a2^2*d2*d3*cos(alpha2) + 4*a3^2*d2*d3*cos(alpha2) - 4*a1^2*d3*d4*cos(alpha3) + 4*a2^2*d3*d4*cos(alpha3) + 4*a3^2*d3*d4*cos(alpha3) + 4*d2*d3*d4^2*cos(alpha2) + 4*d2^2*d3*d4*cos(alpha3) - 4*a2*a3*r*cos(alpha1)^2 - 8*a1^2*d2*z*cos(alpha1) - 4*d2*d4*r*cos(alpha2)*cos(alpha3) - 4*d2*d4^3*cos(alpha1)^2*cos(alpha2)*cos(alpha3) - 4*d2^3*d4*cos(alpha1)^2*cos(alpha2)*cos(alpha3) - 4*d2*d4*r*sin(alpha2)*sin(alpha3) - 8*d2^2*d4^2*cos(alpha1)^2*cos(alpha2)^2*cos(alpha3)^2 - 4*d2*d4^3*cos(alpha1)^2*sin(alpha2)*sin(alpha3) - 4*d2^3*d4*cos(alpha1)^2*sin(alpha2)*sin(alpha3) + 4*a1^2*d2*d4*cos(alpha2)*cos(alpha3) + 4*a2^2*d2*d4*cos(alpha2)*cos(alpha3) + 4*a3^2*d2*d4*cos(alpha2)*cos(alpha3) + 12*d2*d3^2*d4*cos(alpha2)*cos(alpha3) + 4*d2*d3*r*cos(alpha1)^2*cos(alpha2) + 4*d3*d4*r*cos(alpha1)^2*cos(alpha3) - 8*a1^2*d3*z*cos(alpha1)*cos(alpha2) + 4*a1^2*d2*d4*sin(alpha2)*sin(alpha3) + 4*a2^2*d2*d4*sin(alpha2)*sin(alpha3) + 4*a3^2*d2*d4*sin(alpha2)*sin(alpha3) + 4*d2*d3^2*d4*sin(alpha2)*sin(alpha3) - 8*a2*a3*d2*d3*cos(alpha2) - 8*a2*a3*d3*d4*cos(alpha3) + 4*a1^2*d2*d3*cos(alpha1)^2*cos(alpha2) - 4*a2^2*d2*d3*cos(alpha1)^2*cos(alpha2) - 4*a3^2*d2*d3*cos(alpha1)^2*cos(alpha2) + 4*a1^2*d3*d4*cos(alpha1)^2*cos(alpha3) + 8*a1^2*d3*d4*cos(alpha2)^2*cos(alpha3) - 4*a2^2*d3*d4*cos(alpha1)^2*cos(alpha3) - 4*a3^2*d3*d4*cos(alpha1)^2*cos(alpha3) - 4*d2*d3*d4^2*cos(alpha1)^2*cos(alpha2) - 4*d2^2*d3*d4*cos(alpha1)^2*cos(alpha3) + 8*d2*d3*d4^2*cos(alpha2)*cos(alpha3)^2 + 8*d2^2*d3*d4*cos(alpha2)^2*cos(alpha3) + 8*a1^2*d4^2*cos(alpha2)*cos(alpha3)*sin(alpha2)*sin(alpha3) + 8*d2^2*d4^2*cos(alpha2)*cos(alpha3)*sin(alpha2)*sin(alpha3) + 4*d2*d4*r*cos(alpha1)^2*cos(alpha2)*cos(alpha3) - 8*a1^2*d4*z*cos(alpha1)*cos(alpha2)*cos(alpha3) + 8*a1^2*d3*d4*cos(alpha2)*sin(alpha2)*sin(alpha3) + 8*d2^2*d3*d4*cos(alpha2)*sin(alpha2)*sin(alpha3) + 8*d2*d3*d4^2*cos(alpha3)*sin(alpha2)*sin(alpha3) + 4*d2*d4*r*cos(alpha1)^2*sin(alpha2)*sin(alpha3) - 8*a1^2*d4*z*cos(alpha1)*sin(alpha2)*sin(alpha3) - 8*a2*a3*d2*d4*cos(alpha2)*cos(alpha3) - 8*a2*a3*d2*d4*sin(alpha2)*sin(alpha3) + 4*a1^2*d2*d4*cos(alpha1)^2*cos(alpha2)*cos(alpha3) - 4*a2^2*d2*d4*cos(alpha1)^2*cos(alpha2)*cos(alpha3) - 4*a3^2*d2*d4*cos(alpha1)^2*cos(alpha2)*cos(alpha3) - 12*d2*d3^2*d4*cos(alpha1)^2*cos(alpha2)*cos(alpha3) + 4*a1^2*d2*d4*cos(alpha1)^2*sin(alpha2)*sin(alpha3) - 4*a2^2*d2*d4*cos(alpha1)^2*sin(alpha2)*sin(alpha3) - 4*a3^2*d2*d4*cos(alpha1)^2*sin(alpha2)*sin(alpha3) - 4*d2*d3^2*d4*cos(alpha1)^2*sin(alpha2)*sin(alpha3) + 8*a2*a3*d2*d3*cos(alpha1)^2*cos(alpha2) + 8*a2*a3*d3*d4*cos(alpha1)^2*cos(alpha3) - 8*d2*d3*d4^2*cos(alpha1)^2*cos(alpha2)*cos(alpha3)^2 - 8*d2^2*d3*d4*cos(alpha1)^2*cos(alpha2)^2*cos(alpha3) - 8*d2^2*d4^2*cos(alpha1)^2*cos(alpha2)*cos(alpha3)*sin(alpha2)*sin(alpha3) - 8*d2^2*d3*d4*cos(alpha1)^2*cos(alpha2)*sin(alpha2)*sin(alpha3) - 8*d2*d3*d4^2*cos(alpha1)^2*cos(alpha3)*sin(alpha2)*sin(alpha3) + 8*a2*a3*d2*d4*cos(alpha1)^2*cos(alpha2)*cos(alpha3) + 8*a2*a3*d2*d4*cos(alpha1)^2*sin(alpha2)*sin(alpha3);
b = 8*a3*d2^3*sin(alpha2) + 8*a3^3*d2*sin(alpha2) + 8*a2*d4^3*sin(alpha3) + 8*a2^3*d4*sin(alpha3) + 8*a1^2*a3*d3*sin(2*alpha2) + 8*a3*d2^2*d3*sin(2*alpha2) + 8*a2*d3*d4^2*sin(2*alpha3) - 8*a3*d2*r*sin(alpha2) - 8*a2*d4*r*sin(alpha3) - 8*a3*d2^3*cos(alpha1)^2*sin(alpha2) - 8*a3^3*d2*cos(alpha1)^2*sin(alpha2) - 8*a2*d4^3*cos(alpha1)^2*sin(alpha3) - 8*a2^3*d4*cos(alpha1)^2*sin(alpha3) + 8*a1^2*a3*d2*sin(alpha2) - 16*a2*a3^2*d2*sin(alpha2) + 8*a2^2*a3*d2*sin(alpha2) - 8*a1^2*a2*d4*sin(alpha3) + 16*a1^2*a3*d4*sin(alpha3) + 8*a2*a3^2*d4*sin(alpha3) - 16*a2^2*a3*d4*sin(alpha3) + 16*a2*d2*d4^2*sin(alpha2) + 8*a3*d2*d3^2*sin(alpha2) + 8*a2*d2^2*d4*sin(alpha3) + 8*a3*d2*d4^2*sin(alpha2) + 8*a2*d3^2*d4*sin(alpha3) + 16*a3*d2^2*d4*sin(alpha3) + 8*a3*d2*r*cos(alpha1)^2*sin(alpha2) + 8*a2*d4*r*cos(alpha1)^2*sin(alpha3) - 16*a1^2*a3*z*cos(alpha1)*sin(alpha2) + 8*a1^2*a3*d2*cos(alpha1)^2*sin(alpha2) + 16*a2*a3^2*d2*cos(alpha1)^2*sin(alpha2) - 8*a2^2*a3*d2*cos(alpha1)^2*sin(alpha2) + 8*a1^2*a2*d4*cos(alpha1)^2*sin(alpha3) - 8*a2*a3^2*d4*cos(alpha1)^2*sin(alpha3) - 16*a1^2*a3*d4*cos(alpha2)^2*sin(alpha3) + 16*a2^2*a3*d4*cos(alpha1)^2*sin(alpha3) - 16*a2*d2*d4^2*cos(alpha1)^2*sin(alpha2) - 8*a3*d2*d3^2*cos(alpha1)^2*sin(alpha2) - 8*a2*d2^2*d4*cos(alpha1)^2*sin(alpha3) - 8*a3*d2*d4^2*cos(alpha1)^2*sin(alpha2) - 16*a2*d2*d4^2*cos(alpha3)^2*sin(alpha2) - 8*a2*d3^2*d4*cos(alpha1)^2*sin(alpha3) - 16*a3*d2^2*d4*cos(alpha1)^2*sin(alpha3) - 16*a3*d2^2*d4*cos(alpha2)^2*sin(alpha3) + 16*a2*d2*d4^2*cos(alpha1)^2*cos(alpha3)^2*sin(alpha2) + 16*a3*d2^2*d4*cos(alpha1)^2*cos(alpha2)^2*sin(alpha3) + 16*a1^2*a3*d4*cos(alpha2)*cos(alpha3)*sin(alpha2) + 16*a2*d2*d4^2*cos(alpha2)*cos(alpha3)*sin(alpha3) + 16*a3*d2^2*d4*cos(alpha2)*cos(alpha3)*sin(alpha2) + 16*a2*d2*d3*d4*cos(alpha2)*sin(alpha3) + 16*a3*d2*d3*d4*cos(alpha3)*sin(alpha2) - 16*a3*d2^2*d3*cos(alpha1)^2*cos(alpha2)*sin(alpha2) - 16*a2*d3*d4^2*cos(alpha1)^2*cos(alpha3)*sin(alpha3) - 16*a2*d2*d4^2*cos(alpha1)^2*cos(alpha2)*cos(alpha3)*sin(alpha3) - 16*a3*d2^2*d4*cos(alpha1)^2*cos(alpha2)*cos(alpha3)*sin(alpha2) - 16*a2*d2*d3*d4*cos(alpha1)^2*cos(alpha2)*sin(alpha3) - 16*a3*d2*d3*d4*cos(alpha1)^2*cos(alpha3)*sin(alpha2);
c = 2*a1^4 - 2*a2^4*cos(alpha1)^2 - 2*a3^4*cos(alpha1)^2 - 2*d2^4*cos(alpha1)^2 - 2*d3^4*cos(alpha1)^2 - 2*d4^4*cos(alpha1)^2 - 2*r^2*cos(alpha1)^2 - 4*a1^2*r - 4*a2^2*r - 4*a3^2*r - 4*d2^2*r - 4*d3^2*r - 4*d4^2*r - 2*a1^4*cos(alpha1)^2 + 2*a2^4 + 2*a3^4 + 2*d2^4 + 2*d3^4 + 2*d4^4 + 2*r^2 - 4*a1^2*a2^2 + 12*a1^2*a3^2 - 4*a2^2*a3^2 + 4*a1^2*d2^2 - 4*a1^2*d3^2 + 4*a2^2*d2^2 - 12*a1^2*d4^2 + 4*a2^2*d3^2 + 20*a3^2*d2^2 + 20*a2^2*d4^2 + 4*a3^2*d3^2 + 4*a3^2*d4^2 + 4*d2^2*d3^2 - 4*d2^2*d4^2 + 4*d3^2*d4^2 + 8*a1^2*z^2 + 4*a1^2*a2^2*cos(alpha1)^2 + 4*a1^2*a3^2*cos(alpha1)^2 - 16*a1^2*a3^2*cos(alpha2)^2 + 4*a2^2*a3^2*cos(alpha1)^2 + 4*a1^2*d2^2*cos(alpha1)^2 + 4*a1^2*d3^2*cos(alpha1)^2 - 4*a2^2*d2^2*cos(alpha1)^2 + 8*a1^2*d3^2*cos(alpha2)^2 + 4*a1^2*d4^2*cos(alpha1)^2 - 4*a2^2*d3^2*cos(alpha1)^2 - 20*a3^2*d2^2*cos(alpha1)^2 + 8*a1^2*d4^2*cos(alpha2)^2 - 20*a2^2*d4^2*cos(alpha1)^2 - 16*a3^2*d2^2*cos(alpha2)^2 - 4*a3^2*d3^2*cos(alpha1)^2 + 8*a1^2*d4^2*cos(alpha3)^2 - 4*a3^2*d4^2*cos(alpha1)^2 - 16*a2^2*d4^2*cos(alpha3)^2 - 4*d2^2*d3^2*cos(alpha1)^2 + 8*d2^2*d3^2*cos(alpha2)^2 + 4*d2^2*d4^2*cos(alpha1)^2 + 8*d2^2*d4^2*cos(alpha2)^2 - 4*d3^2*d4^2*cos(alpha1)^2 + 8*d2^2*d4^2*cos(alpha3)^2 + 8*d3^2*d4^2*cos(alpha3)^2 + 8*d2*d3^3*cos(alpha2) + 8*d2^3*d3*cos(alpha2) + 8*d3*d4^3*cos(alpha3) + 8*d3^3*d4*cos(alpha3) + 4*a1^2*r*cos(alpha1)^2 + 4*a2^2*r*cos(alpha1)^2 + 4*a3^2*r*cos(alpha1)^2 + 4*d2^2*r*cos(alpha1)^2 + 4*d3^2*r*cos(alpha1)^2 + 4*d4^2*r*cos(alpha1)^2 + 8*d2*d4^3*cos(alpha2)*cos(alpha3) + 8*d2^3*d4*cos(alpha2)*cos(alpha3) + 16*a3^2*d2^2*cos(alpha1)^2*cos(alpha2)^2 + 16*a2^2*d4^2*cos(alpha1)^2*cos(alpha3)^2 - 8*d2^2*d3^2*cos(alpha1)^2*cos(alpha2)^2 - 8*d2^2*d4^2*cos(alpha1)^2*cos(alpha2)^2 - 8*d2^2*d4^2*cos(alpha1)^2*cos(alpha3)^2 - 8*d3^2*d4^2*cos(alpha1)^2*cos(alpha3)^2 - 8*d2*d3*r*cos(alpha2) - 8*d3*d4*r*cos(alpha3) - 8*d2*d3^3*cos(alpha1)^2*cos(alpha2) - 8*d2^3*d3*cos(alpha1)^2*cos(alpha2) - 8*d3*d4^3*cos(alpha1)^2*cos(alpha3) - 8*d3^3*d4*cos(alpha1)^2*cos(alpha3) + 8*a1^2*d2*d3*cos(alpha2) + 8*a2^2*d2*d3*cos(alpha2) + 8*a3^2*d2*d3*cos(alpha2) - 8*a1^2*d3*d4*cos(alpha3) + 8*a2^2*d3*d4*cos(alpha3) + 8*a3^2*d3*d4*cos(alpha3) + 8*d2*d3*d4^2*cos(alpha2) + 8*d2^2*d3*d4*cos(alpha3) - 16*a1^2*d2*z*cos(alpha1) - 8*d2*d4*r*cos(alpha2)*cos(alpha3) - 8*d2*d4^3*cos(alpha1)^2*cos(alpha2)*cos(alpha3) - 8*d2^3*d4*cos(alpha1)^2*cos(alpha2)*cos(alpha3) + 8*a1^2*d2*d4*cos(alpha2)*cos(alpha3) + 8*a2^2*d2*d4*cos(alpha2)*cos(alpha3) + 8*a3^2*d2*d4*cos(alpha2)*cos(alpha3) + 24*d2*d3^2*d4*cos(alpha2)*cos(alpha3) + 8*d2*d3*r*cos(alpha1)^2*cos(alpha2) + 8*d3*d4*r*cos(alpha1)^2*cos(alpha3) - 16*a1^2*d3*z*cos(alpha1)*cos(alpha2) + 8*a1^2*d2*d3*cos(alpha1)^2*cos(alpha2) - 8*a2^2*d2*d3*cos(alpha1)^2*cos(alpha2) - 8*a3^2*d2*d3*cos(alpha1)^2*cos(alpha2) + 8*a1^2*d3*d4*cos(alpha1)^2*cos(alpha3) + 16*a1^2*d3*d4*cos(alpha2)^2*cos(alpha3) - 8*a2^2*d3*d4*cos(alpha1)^2*cos(alpha3) - 8*a3^2*d3*d4*cos(alpha1)^2*cos(alpha3) - 8*d2*d3*d4^2*cos(alpha1)^2*cos(alpha2) - 8*d2^2*d3*d4*cos(alpha1)^2*cos(alpha3) + 16*d2*d3*d4^2*cos(alpha2)*cos(alpha3)^2 + 16*d2^2*d3*d4*cos(alpha2)^2*cos(alpha3) + 8*d2*d4*r*cos(alpha1)^2*cos(alpha2)*cos(alpha3) - 16*a1^2*d4*z*cos(alpha1)*cos(alpha2)*cos(alpha3) + 48*a2*a3*d2*d4*sin(alpha2)*sin(alpha3) + 8*a1^2*d2*d4*cos(alpha1)^2*cos(alpha2)*cos(alpha3) - 8*a2^2*d2*d4*cos(alpha1)^2*cos(alpha2)*cos(alpha3) - 8*a3^2*d2*d4*cos(alpha1)^2*cos(alpha2)*cos(alpha3) - 24*d2*d3^2*d4*cos(alpha1)^2*cos(alpha2)*cos(alpha3) - 16*d2*d3*d4^2*cos(alpha1)^2*cos(alpha2)*cos(alpha3)^2 - 16*d2^2*d3*d4*cos(alpha1)^2*cos(alpha2)^2*cos(alpha3) - 48*a2*a3*d2*d4*cos(alpha1)^2*sin(alpha2)*sin(alpha3);
d = 8*a3*d2^3*sin(alpha2) + 8*a3^3*d2*sin(alpha2) + 8*a2*d4^3*sin(alpha3) + 8*a2^3*d4*sin(alpha3) + 8*a1^2*a3*d3*sin(2*alpha2) + 8*a3*d2^2*d3*sin(2*alpha2) + 8*a2*d3*d4^2*sin(2*alpha3) - 8*a3*d2*r*sin(alpha2) - 8*a2*d4*r*sin(alpha3) - 8*a3*d2^3*cos(alpha1)^2*sin(alpha2) - 8*a3^3*d2*cos(alpha1)^2*sin(alpha2) - 8*a2*d4^3*cos(alpha1)^2*sin(alpha3) - 8*a2^3*d4*cos(alpha1)^2*sin(alpha3) + 8*a1^2*a3*d2*sin(alpha2) + 16*a2*a3^2*d2*sin(alpha2) + 8*a2^2*a3*d2*sin(alpha2) - 8*a1^2*a2*d4*sin(alpha3) - 16*a1^2*a3*d4*sin(alpha3) + 8*a2*a3^2*d4*sin(alpha3) + 16*a2^2*a3*d4*sin(alpha3) - 16*a2*d2*d4^2*sin(alpha2) + 8*a3*d2*d3^2*sin(alpha2) + 8*a2*d2^2*d4*sin(alpha3) + 8*a3*d2*d4^2*sin(alpha2) + 8*a2*d3^2*d4*sin(alpha3) - 16*a3*d2^2*d4*sin(alpha3) + 8*a3*d2*r*cos(alpha1)^2*sin(alpha2) + 8*a2*d4*r*cos(alpha1)^2*sin(alpha3) - 16*a1^2*a3*z*cos(alpha1)*sin(alpha2) + 8*a1^2*a3*d2*cos(alpha1)^2*sin(alpha2) - 16*a2*a3^2*d2*cos(alpha1)^2*sin(alpha2) - 8*a2^2*a3*d2*cos(alpha1)^2*sin(alpha2) + 8*a1^2*a2*d4*cos(alpha1)^2*sin(alpha3) - 8*a2*a3^2*d4*cos(alpha1)^2*sin(alpha3) + 16*a1^2*a3*d4*cos(alpha2)^2*sin(alpha3) - 16*a2^2*a3*d4*cos(alpha1)^2*sin(alpha3) + 16*a2*d2*d4^2*cos(alpha1)^2*sin(alpha2) - 8*a3*d2*d3^2*cos(alpha1)^2*sin(alpha2) - 8*a2*d2^2*d4*cos(alpha1)^2*sin(alpha3) - 8*a3*d2*d4^2*cos(alpha1)^2*sin(alpha2) + 16*a2*d2*d4^2*cos(alpha3)^2*sin(alpha2) - 8*a2*d3^2*d4*cos(alpha1)^2*sin(alpha3) + 16*a3*d2^2*d4*cos(alpha1)^2*sin(alpha3) + 16*a3*d2^2*d4*cos(alpha2)^2*sin(alpha3) - 16*a2*d2*d4^2*cos(alpha1)^2*cos(alpha3)^2*sin(alpha2) - 16*a3*d2^2*d4*cos(alpha1)^2*cos(alpha2)^2*sin(alpha3) + 16*a1^2*a3*d4*cos(alpha2)*cos(alpha3)*sin(alpha2) + 16*a2*d2*d4^2*cos(alpha2)*cos(alpha3)*sin(alpha3) + 16*a3*d2^2*d4*cos(alpha2)*cos(alpha3)*sin(alpha2) + 16*a2*d2*d3*d4*cos(alpha2)*sin(alpha3) + 16*a3*d2*d3*d4*cos(alpha3)*sin(alpha2) - 16*a3*d2^2*d3*cos(alpha1)^2*cos(alpha2)*sin(alpha2) - 16*a2*d3*d4^2*cos(alpha1)^2*cos(alpha3)*sin(alpha3) - 16*a2*d2*d4^2*cos(alpha1)^2*cos(alpha2)*cos(alpha3)*sin(alpha3) - 16*a3*d2^2*d4*cos(alpha1)^2*cos(alpha2)*cos(alpha3)*sin(alpha2) - 16*a2*d2*d3*d4*cos(alpha1)^2*cos(alpha2)*sin(alpha3) - 16*a3*d2*d3*d4*cos(alpha1)^2*cos(alpha3)*sin(alpha2);
e = 4*a2*a3^3 - a2^4*cos(alpha1)^2 - a3^4*cos(alpha1)^2 - d2^4*cos(alpha1)^2 - d3^4*cos(alpha1)^2 - d4^4*cos(alpha1)^2 - r^2*cos(alpha1)^2 - a1^4*cos(alpha1)^2 + 4*a2^3*a3 - 2*a1^2*r - 2*a2^2*r - 2*a3^2*r - 2*d2^2*r - 2*d3^2*r - 2*d4^2*r + a1^4 + a2^4 + a3^4 + d2^4 + d3^4 + d4^4 + r^2 - 2*a1^2*a2^2 - 2*a1^2*a3^2 + 6*a2^2*a3^2 + 2*a1^2*d2^2 - 2*a1^2*d3^2 + 2*a2^2*d2^2 + 2*a1^2*d4^2 + 2*a2^2*d3^2 + 2*a3^2*d2^2 + 2*a2^2*d4^2 + 2*a3^2*d3^2 + 2*a3^2*d4^2 + 2*d2^2*d3^2 + 6*d2^2*d4^2 + 2*d3^2*d4^2 + 4*a1^2*z^2 + 2*a1^2*a2^2*cos(alpha1)^2 + 2*a1^2*a3^2*cos(alpha1)^2 - 6*a2^2*a3^2*cos(alpha1)^2 + 2*a1^2*d2^2*cos(alpha1)^2 + 2*a1^2*d3^2*cos(alpha1)^2 - 2*a2^2*d2^2*cos(alpha1)^2 + 4*a1^2*d3^2*cos(alpha2)^2 + 2*a1^2*d4^2*cos(alpha1)^2 - 2*a2^2*d3^2*cos(alpha1)^2 - 2*a3^2*d2^2*cos(alpha1)^2 - 4*a1^2*d4^2*cos(alpha2)^2 - 2*a2^2*d4^2*cos(alpha1)^2 - 2*a3^2*d3^2*cos(alpha1)^2 - 4*a1^2*d4^2*cos(alpha3)^2 - 2*a3^2*d4^2*cos(alpha1)^2 - 2*d2^2*d3^2*cos(alpha1)^2 + 4*d2^2*d3^2*cos(alpha2)^2 - 6*d2^2*d4^2*cos(alpha1)^2 - 4*d2^2*d4^2*cos(alpha2)^2 - 2*d3^2*d4^2*cos(alpha1)^2 - 4*d2^2*d4^2*cos(alpha3)^2 + 4*d3^2*d4^2*cos(alpha3)^2 + 4*d2*d3^3*cos(alpha2) + 4*d2^3*d3*cos(alpha2) + 4*d3*d4^3*cos(alpha3) + 4*d3^3*d4*cos(alpha3) - 4*a2*a3*r - 4*a2*a3^3*cos(alpha1)^2 - 4*a2^3*a3*cos(alpha1)^2 + 2*a1^2*r*cos(alpha1)^2 + 2*a2^2*r*cos(alpha1)^2 + 2*a3^2*r*cos(alpha1)^2 + 2*d2^2*r*cos(alpha1)^2 + 2*d3^2*r*cos(alpha1)^2 + 2*d4^2*r*cos(alpha1)^2 - 4*a1^2*a2*a3 + 4*a2*a3*d2^2 + 4*a2*a3*d3^2 + 4*a2*a3*d4^2 + 4*a1^2*a2*a3*cos(alpha1)^2 - 4*a2*a3*d2^2*cos(alpha1)^2 - 4*a2*a3*d3^2*cos(alpha1)^2 - 4*a2*a3*d4^2*cos(alpha1)^2 + 4*d2*d4^3*cos(alpha2)*cos(alpha3) + 4*d2^3*d4*cos(alpha2)*cos(alpha3) + 8*a1^2*d4^2*cos(alpha2)^2*cos(alpha3)^2 - 4*d2^2*d3^2*cos(alpha1)^2*cos(alpha2)^2 + 4*d2^2*d4^2*cos(alpha1)^2*cos(alpha2)^2 + 4*d2^2*d4^2*cos(alpha1)^2*cos(alpha3)^2 + 8*d2^2*d4^2*cos(alpha2)^2*cos(alpha3)^2 - 4*d3^2*d4^2*cos(alpha1)^2*cos(alpha3)^2 - 4*d2*d4^3*sin(alpha2)*sin(alpha3) - 4*d2^3*d4*sin(alpha2)*sin(alpha3) - 4*d2*d3*r*cos(alpha2) - 4*d3*d4*r*cos(alpha3) - 4*d2*d3^3*cos(alpha1)^2*cos(alpha2) - 4*d2^3*d3*cos(alpha1)^2*cos(alpha2) - 4*d3*d4^3*cos(alpha1)^2*cos(alpha3) - 4*d3^3*d4*cos(alpha1)^2*cos(alpha3) + 4*a1^2*d2*d3*cos(alpha2) + 4*a2^2*d2*d3*cos(alpha2) + 4*a3^2*d2*d3*cos(alpha2) - 4*a1^2*d3*d4*cos(alpha3) + 4*a2^2*d3*d4*cos(alpha3) + 4*a3^2*d3*d4*cos(alpha3) + 4*d2*d3*d4^2*cos(alpha2) + 4*d2^2*d3*d4*cos(alpha3) + 4*a2*a3*r*cos(alpha1)^2 - 8*a1^2*d2*z*cos(alpha1) - 4*d2*d4*r*cos(alpha2)*cos(alpha3) - 4*d2*d4^3*cos(alpha1)^2*cos(alpha2)*cos(alpha3) - 4*d2^3*d4*cos(alpha1)^2*cos(alpha2)*cos(alpha3) + 4*d2*d4*r*sin(alpha2)*sin(alpha3) - 8*d2^2*d4^2*cos(alpha1)^2*cos(alpha2)^2*cos(alpha3)^2 + 4*d2*d4^3*cos(alpha1)^2*sin(alpha2)*sin(alpha3) + 4*d2^3*d4*cos(alpha1)^2*sin(alpha2)*sin(alpha3) + 4*a1^2*d2*d4*cos(alpha2)*cos(alpha3) + 4*a2^2*d2*d4*cos(alpha2)*cos(alpha3) + 4*a3^2*d2*d4*cos(alpha2)*cos(alpha3) + 12*d2*d3^2*d4*cos(alpha2)*cos(alpha3) + 4*d2*d3*r*cos(alpha1)^2*cos(alpha2) + 4*d3*d4*r*cos(alpha1)^2*cos(alpha3) - 8*a1^2*d3*z*cos(alpha1)*cos(alpha2) - 4*a1^2*d2*d4*sin(alpha2)*sin(alpha3) - 4*a2^2*d2*d4*sin(alpha2)*sin(alpha3) - 4*a3^2*d2*d4*sin(alpha2)*sin(alpha3) - 4*d2*d3^2*d4*sin(alpha2)*sin(alpha3) + 8*a2*a3*d2*d3*cos(alpha2) + 8*a2*a3*d3*d4*cos(alpha3) + 4*a1^2*d2*d3*cos(alpha1)^2*cos(alpha2) - 4*a2^2*d2*d3*cos(alpha1)^2*cos(alpha2) - 4*a3^2*d2*d3*cos(alpha1)^2*cos(alpha2) + 4*a1^2*d3*d4*cos(alpha1)^2*cos(alpha3) + 8*a1^2*d3*d4*cos(alpha2)^2*cos(alpha3) - 4*a2^2*d3*d4*cos(alpha1)^2*cos(alpha3) - 4*a3^2*d3*d4*cos(alpha1)^2*cos(alpha3) - 4*d2*d3*d4^2*cos(alpha1)^2*cos(alpha2) - 4*d2^2*d3*d4*cos(alpha1)^2*cos(alpha3) + 8*d2*d3*d4^2*cos(alpha2)*cos(alpha3)^2 + 8*d2^2*d3*d4*cos(alpha2)^2*cos(alpha3) - 8*a1^2*d4^2*cos(alpha2)*cos(alpha3)*sin(alpha2)*sin(alpha3) - 8*d2^2*d4^2*cos(alpha2)*cos(alpha3)*sin(alpha2)*sin(alpha3) + 4*d2*d4*r*cos(alpha1)^2*cos(alpha2)*cos(alpha3) - 8*a1^2*d4*z*cos(alpha1)*cos(alpha2)*cos(alpha3) - 8*a1^2*d3*d4*cos(alpha2)*sin(alpha2)*sin(alpha3) - 8*d2^2*d3*d4*cos(alpha2)*sin(alpha2)*sin(alpha3) - 8*d2*d3*d4^2*cos(alpha3)*sin(alpha2)*sin(alpha3) - 4*d2*d4*r*cos(alpha1)^2*sin(alpha2)*sin(alpha3) + 8*a1^2*d4*z*cos(alpha1)*sin(alpha2)*sin(alpha3) + 8*a2*a3*d2*d4*cos(alpha2)*cos(alpha3) - 8*a2*a3*d2*d4*sin(alpha2)*sin(alpha3) + 4*a1^2*d2*d4*cos(alpha1)^2*cos(alpha2)*cos(alpha3) - 4*a2^2*d2*d4*cos(alpha1)^2*cos(alpha2)*cos(alpha3) - 4*a3^2*d2*d4*cos(alpha1)^2*cos(alpha2)*cos(alpha3) - 12*d2*d3^2*d4*cos(alpha1)^2*cos(alpha2)*cos(alpha3) - 4*a1^2*d2*d4*cos(alpha1)^2*sin(alpha2)*sin(alpha3) + 4*a2^2*d2*d4*cos(alpha1)^2*sin(alpha2)*sin(alpha3) + 4*a3^2*d2*d4*cos(alpha1)^2*sin(alpha2)*sin(alpha3) + 4*d2*d3^2*d4*cos(alpha1)^2*sin(alpha2)*sin(alpha3) - 8*a2*a3*d2*d3*cos(alpha1)^2*cos(alpha2) - 8*a2*a3*d3*d4*cos(alpha1)^2*cos(alpha3) - 8*d2*d3*d4^2*cos(alpha1)^2*cos(alpha2)*cos(alpha3)^2 - 8*d2^2*d3*d4*cos(alpha1)^2*cos(alpha2)^2*cos(alpha3) + 8*d2^2*d4^2*cos(alpha1)^2*cos(alpha2)*cos(alpha3)*sin(alpha2)*sin(alpha3) + 8*d2^2*d3*d4*cos(alpha1)^2*cos(alpha2)*sin(alpha2)*sin(alpha3) + 8*d2*d3*d4^2*cos(alpha1)^2*cos(alpha3)*sin(alpha2)*sin(alpha3) - 8*a2*a3*d2*d4*cos(alpha1)^2*cos(alpha2)*cos(alpha3) + 8*a2*a3*d2*d4*cos(alpha1)^2*sin(alpha2)*sin(alpha3);


% Pieper/Spong DH convension
a = a1^4*sin(alpha1)^2 + a2^4*sin(alpha1)^2 + a3^4*sin(alpha1)^2 + d2^4*sin(alpha1)^2 + d3^4*sin(alpha1)^2 + d4^4*sin(alpha1)^2 + r^2*sin(alpha1)^2 + 4*a1^2*z^2 + 4*a1^2*d2^2*cos(alpha1)^2 - 2*a1^2*a2^2*sin(alpha1)^2 - 2*a1^2*a3^2*sin(alpha1)^2 + 6*a2^2*a3^2*sin(alpha1)^2 + 2*a1^2*d2^2*sin(alpha1)^2 + 2*a1^2*d3^2*sin(alpha1)^2 + 2*a2^2*d2^2*sin(alpha1)^2 + 2*a1^2*d4^2*sin(alpha1)^2 + 2*a2^2*d3^2*sin(alpha1)^2 + 2*a3^2*d2^2*sin(alpha1)^2 + 2*a2^2*d4^2*sin(alpha1)^2 + 2*a3^2*d3^2*sin(alpha1)^2 + 2*a3^2*d4^2*sin(alpha1)^2 + 2*d2^2*d3^2*sin(alpha1)^2 + 2*d2^2*d4^2*sin(alpha1)^2 + 2*d3^2*d4^2*sin(alpha1)^2 - 4*a2*a3^3*sin(alpha1)^2 - 4*a2^3*a3*sin(alpha1)^2 - 2*a1^2*r*sin(alpha1)^2 - 2*a2^2*r*sin(alpha1)^2 - 2*a3^2*r*sin(alpha1)^2 - 2*d2^2*r*sin(alpha1)^2 - 2*d3^2*r*sin(alpha1)^2 - 2*d4^2*r*sin(alpha1)^2 + 4*a1^2*a2*a3*sin(alpha1)^2 - 4*a2*a3*d2^2*sin(alpha1)^2 - 4*a2*a3*d3^2*sin(alpha1)^2 - 4*a2*a3*d4^2*sin(alpha1)^2 + 4*a1^2*d3^2*cos(alpha1)^2*cos(alpha2)^2 + 4*d2^2*d3^2*cos(alpha2)^2*sin(alpha1)^2 + 4*d3^2*d4^2*cos(alpha3)^2*sin(alpha1)^2 - 4*a1^2*d3^2*sin(alpha1)^2*sin(alpha2)^2 + 4*d2*d3^3*cos(alpha2)*sin(alpha1)^2 + 4*d2^3*d3*cos(alpha2)*sin(alpha1)^2 + 4*d3*d4^3*cos(alpha3)*sin(alpha1)^2 + 4*d3^3*d4*cos(alpha3)*sin(alpha1)^2 - 8*a1^2*d2*z*cos(alpha1) + 4*a2*a3*r*sin(alpha1)^2 + 4*d2*d4^3*cos(alpha2)*cos(alpha3)*sin(alpha1)^2 + 4*d2^3*d4*cos(alpha2)*cos(alpha3)*sin(alpha1)^2 + 4*a1^2*d4^2*cos(alpha1)^2*cos(alpha2)^2*cos(alpha3)^2 + 4*d2^2*d4^2*cos(alpha2)^2*cos(alpha3)^2*sin(alpha1)^2 + 4*d2*d4^3*sin(alpha1)^2*sin(alpha2)*sin(alpha3) + 4*d2^3*d4*sin(alpha1)^2*sin(alpha2)*sin(alpha3) + 4*a1^2*d4^2*cos(alpha1)^2*sin(alpha2)^2*sin(alpha3)^2 - 4*a1^2*d4^2*cos(alpha2)^2*sin(alpha1)^2*sin(alpha3)^2 - 4*a1^2*d4^2*cos(alpha3)^2*sin(alpha1)^2*sin(alpha2)^2 + 4*d2^2*d4^2*sin(alpha1)^2*sin(alpha2)^2*sin(alpha3)^2 - 8*a1^2*d3*z*cos(alpha1)*cos(alpha2) - 4*d2*d3*r*cos(alpha2)*sin(alpha1)^2 - 4*d3*d4*r*cos(alpha3)*sin(alpha1)^2 + 8*a1^2*d2*d3*cos(alpha1)^2*cos(alpha2) + 4*a1^2*d2*d3*cos(alpha2)*sin(alpha1)^2 + 4*a2^2*d2*d3*cos(alpha2)*sin(alpha1)^2 + 4*a3^2*d2*d3*cos(alpha2)*sin(alpha1)^2 + 4*a1^2*d3*d4*cos(alpha3)*sin(alpha1)^2 + 4*a2^2*d3*d4*cos(alpha3)*sin(alpha1)^2 + 4*a3^2*d3*d4*cos(alpha3)*sin(alpha1)^2 + 4*d2*d3*d4^2*cos(alpha2)*sin(alpha1)^2 + 4*d2^2*d3*d4*cos(alpha3)*sin(alpha1)^2 + 8*d2*d3*d4^2*cos(alpha2)*cos(alpha3)^2*sin(alpha1)^2 + 8*d2^2*d3*d4*cos(alpha2)^2*cos(alpha3)*sin(alpha1)^2 - 8*a1^2*d3*d4*cos(alpha3)*sin(alpha1)^2*sin(alpha2)^2 - 8*a1^2*d4*z*cos(alpha1)*cos(alpha2)*cos(alpha3) - 4*d2*d4*r*cos(alpha2)*cos(alpha3)*sin(alpha1)^2 - 8*a1^2*d4*z*cos(alpha1)*sin(alpha2)*sin(alpha3) - 4*d2*d4*r*sin(alpha1)^2*sin(alpha2)*sin(alpha3) + 8*a1^2*d2*d4*cos(alpha1)^2*cos(alpha2)*cos(alpha3) + 4*a1^2*d2*d4*cos(alpha2)*cos(alpha3)*sin(alpha1)^2 + 4*a2^2*d2*d4*cos(alpha2)*cos(alpha3)*sin(alpha1)^2 + 4*a3^2*d2*d4*cos(alpha2)*cos(alpha3)*sin(alpha1)^2 + 12*d2*d3^2*d4*cos(alpha2)*cos(alpha3)*sin(alpha1)^2 + 8*a1^2*d2*d4*cos(alpha1)^2*sin(alpha2)*sin(alpha3) + 4*a1^2*d2*d4*sin(alpha1)^2*sin(alpha2)*sin(alpha3) + 4*a2^2*d2*d4*sin(alpha1)^2*sin(alpha2)*sin(alpha3) + 4*a3^2*d2*d4*sin(alpha1)^2*sin(alpha2)*sin(alpha3) + 4*d2*d3^2*d4*sin(alpha1)^2*sin(alpha2)*sin(alpha3) - 8*a2*a3*d2*d3*cos(alpha2)*sin(alpha1)^2 - 8*a2*a3*d3*d4*cos(alpha3)*sin(alpha1)^2 + 8*a1^2*d3*d4*cos(alpha1)^2*cos(alpha2)^2*cos(alpha3) + 8*a1^2*d4^2*cos(alpha1)^2*cos(alpha2)*cos(alpha3)*sin(alpha2)*sin(alpha3) + 8*a1^2*d4^2*cos(alpha2)*cos(alpha3)*sin(alpha1)^2*sin(alpha2)*sin(alpha3) + 8*d2^2*d4^2*cos(alpha2)*cos(alpha3)*sin(alpha1)^2*sin(alpha2)*sin(alpha3) + 8*a1^2*d3*d4*cos(alpha1)^2*cos(alpha2)*sin(alpha2)*sin(alpha3) + 8*a1^2*d3*d4*cos(alpha2)*sin(alpha1)^2*sin(alpha2)*sin(alpha3) + 8*d2^2*d3*d4*cos(alpha2)*sin(alpha1)^2*sin(alpha2)*sin(alpha3) + 8*d2*d3*d4^2*cos(alpha3)*sin(alpha1)^2*sin(alpha2)*sin(alpha3) - 8*a2*a3*d2*d4*cos(alpha2)*cos(alpha3)*sin(alpha1)^2 - 8*a2*a3*d2*d4*sin(alpha1)^2*sin(alpha2)*sin(alpha3);
b = 8*a3*d2^3*sin(alpha1)^2*sin(alpha2) + 8*a3^3*d2*sin(alpha1)^2*sin(alpha2) + 8*a2*d4^3*sin(alpha1)^2*sin(alpha3) + 8*a2^3*d4*sin(alpha1)^2*sin(alpha3) - 16*a1^2*a3*z*cos(alpha1)*sin(alpha2) - 8*a3*d2*r*sin(alpha1)^2*sin(alpha2) - 8*a2*d4*r*sin(alpha1)^2*sin(alpha3) + 16*a1^2*a3*d2*cos(alpha1)^2*sin(alpha2) + 8*a1^2*a3*d2*sin(alpha1)^2*sin(alpha2) - 16*a2*a3^2*d2*sin(alpha1)^2*sin(alpha2) + 8*a2^2*a3*d2*sin(alpha1)^2*sin(alpha2) - 8*a1^2*a2*d4*sin(alpha1)^2*sin(alpha3) + 16*a1^2*a3*d4*sin(alpha1)^2*sin(alpha3) + 8*a2*a3^2*d4*sin(alpha1)^2*sin(alpha3) - 16*a2^2*a3*d4*sin(alpha1)^2*sin(alpha3) + 8*a3*d2*d3^2*sin(alpha1)^2*sin(alpha2) + 8*a2*d2^2*d4*sin(alpha1)^2*sin(alpha3) + 8*a3*d2*d4^2*sin(alpha1)^2*sin(alpha2) + 8*a2*d3^2*d4*sin(alpha1)^2*sin(alpha3) + 16*a1^2*a3*d4*cos(alpha1)^2*sin(alpha2)^2*sin(alpha3) - 16*a1^2*a3*d4*cos(alpha2)^2*sin(alpha1)^2*sin(alpha3) + 16*a2*d2*d4^2*sin(alpha1)^2*sin(alpha2)*sin(alpha3)^2 + 16*a3*d2^2*d4*sin(alpha1)^2*sin(alpha2)^2*sin(alpha3) + 16*a1^2*a3*d3*cos(alpha1)^2*cos(alpha2)*sin(alpha2) + 16*a1^2*a3*d3*cos(alpha2)*sin(alpha1)^2*sin(alpha2) + 16*a3*d2^2*d3*cos(alpha2)*sin(alpha1)^2*sin(alpha2) + 16*a2*d3*d4^2*cos(alpha3)*sin(alpha1)^2*sin(alpha3) + 16*a1^2*a3*d4*cos(alpha1)^2*cos(alpha2)*cos(alpha3)*sin(alpha2) + 16*a1^2*a3*d4*cos(alpha2)*cos(alpha3)*sin(alpha1)^2*sin(alpha2) + 16*a2*d2*d4^2*cos(alpha2)*cos(alpha3)*sin(alpha1)^2*sin(alpha3) + 16*a3*d2^2*d4*cos(alpha2)*cos(alpha3)*sin(alpha1)^2*sin(alpha2) + 16*a2*d2*d3*d4*cos(alpha2)*sin(alpha1)^2*sin(alpha3) + 16*a3*d2*d3*d4*cos(alpha3)*sin(alpha1)^2*sin(alpha2);
c = 2*a1^4*sin(alpha1)^2 + 2*a2^4*sin(alpha1)^2 + 2*a3^4*sin(alpha1)^2 + 2*d2^4*sin(alpha1)^2 + 2*d3^4*sin(alpha1)^2 + 2*d4^4*sin(alpha1)^2 + 2*r^2*sin(alpha1)^2 + 8*a1^2*z^2 + 8*a1^2*d2^2*cos(alpha1)^2 - 4*a1^2*a2^2*sin(alpha1)^2 + 12*a1^2*a3^2*sin(alpha1)^2 - 4*a2^2*a3^2*sin(alpha1)^2 + 4*a1^2*d2^2*sin(alpha1)^2 + 4*a1^2*d3^2*sin(alpha1)^2 + 4*a2^2*d2^2*sin(alpha1)^2 + 4*a1^2*d4^2*sin(alpha1)^2 + 4*a2^2*d3^2*sin(alpha1)^2 + 4*a3^2*d2^2*sin(alpha1)^2 + 4*a2^2*d4^2*sin(alpha1)^2 + 4*a3^2*d3^2*sin(alpha1)^2 + 4*a3^2*d4^2*sin(alpha1)^2 + 4*d2^2*d3^2*sin(alpha1)^2 + 4*d2^2*d4^2*sin(alpha1)^2 + 4*d3^2*d4^2*sin(alpha1)^2 - 4*a1^2*r*sin(alpha1)^2 - 4*a2^2*r*sin(alpha1)^2 - 4*a3^2*r*sin(alpha1)^2 - 4*d2^2*r*sin(alpha1)^2 - 4*d3^2*r*sin(alpha1)^2 - 4*d4^2*r*sin(alpha1)^2 + 8*a1^2*d3^2*cos(alpha1)^2*cos(alpha2)^2 + 16*a1^2*a3^2*cos(alpha1)^2*sin(alpha2)^2 - 16*a1^2*a3^2*cos(alpha2)^2*sin(alpha1)^2 + 8*d2^2*d3^2*cos(alpha2)^2*sin(alpha1)^2 + 8*d3^2*d4^2*cos(alpha3)^2*sin(alpha1)^2 - 8*a1^2*d3^2*sin(alpha1)^2*sin(alpha2)^2 + 16*a3^2*d2^2*sin(alpha1)^2*sin(alpha2)^2 - 16*a1^2*d4^2*sin(alpha1)^2*sin(alpha3)^2 + 16*a2^2*d4^2*sin(alpha1)^2*sin(alpha3)^2 + 8*d2*d3^3*cos(alpha2)*sin(alpha1)^2 + 8*d2^3*d3*cos(alpha2)*sin(alpha1)^2 + 8*d3*d4^3*cos(alpha3)*sin(alpha1)^2 + 8*d3^3*d4*cos(alpha3)*sin(alpha1)^2 - 16*a1^2*d2*z*cos(alpha1) + 8*d2*d4^3*cos(alpha2)*cos(alpha3)*sin(alpha1)^2 + 8*d2^3*d4*cos(alpha2)*cos(alpha3)*sin(alpha1)^2 + 8*a1^2*d4^2*cos(alpha1)^2*cos(alpha2)^2*cos(alpha3)^2 + 8*d2^2*d4^2*cos(alpha2)^2*cos(alpha3)^2*sin(alpha1)^2 - 8*a1^2*d4^2*cos(alpha1)^2*sin(alpha2)^2*sin(alpha3)^2 + 8*a1^2*d4^2*cos(alpha2)^2*sin(alpha1)^2*sin(alpha3)^2 - 8*a1^2*d4^2*cos(alpha3)^2*sin(alpha1)^2*sin(alpha2)^2 - 8*d2^2*d4^2*sin(alpha1)^2*sin(alpha2)^2*sin(alpha3)^2 - 16*a1^2*d3*z*cos(alpha1)*cos(alpha2) - 8*d2*d3*r*cos(alpha2)*sin(alpha1)^2 - 8*d3*d4*r*cos(alpha3)*sin(alpha1)^2 + 16*a1^2*d2*d3*cos(alpha1)^2*cos(alpha2) + 8*a1^2*d2*d3*cos(alpha2)*sin(alpha1)^2 + 8*a2^2*d2*d3*cos(alpha2)*sin(alpha1)^2 + 8*a3^2*d2*d3*cos(alpha2)*sin(alpha1)^2 + 8*a1^2*d3*d4*cos(alpha3)*sin(alpha1)^2 + 8*a2^2*d3*d4*cos(alpha3)*sin(alpha1)^2 + 8*a3^2*d3*d4*cos(alpha3)*sin(alpha1)^2 + 8*d2*d3*d4^2*cos(alpha2)*sin(alpha1)^2 + 8*d2^2*d3*d4*cos(alpha3)*sin(alpha1)^2 + 16*d2*d3*d4^2*cos(alpha2)*cos(alpha3)^2*sin(alpha1)^2 + 16*d2^2*d3*d4*cos(alpha2)^2*cos(alpha3)*sin(alpha1)^2 - 16*a1^2*d3*d4*cos(alpha3)*sin(alpha1)^2*sin(alpha2)^2 - 16*a1^2*d4*z*cos(alpha1)*cos(alpha2)*cos(alpha3) - 8*d2*d4*r*cos(alpha2)*cos(alpha3)*sin(alpha1)^2 + 16*a1^2*d2*d4*cos(alpha1)^2*cos(alpha2)*cos(alpha3) + 8*a1^2*d2*d4*cos(alpha2)*cos(alpha3)*sin(alpha1)^2 + 8*a2^2*d2*d4*cos(alpha2)*cos(alpha3)*sin(alpha1)^2 + 8*a3^2*d2*d4*cos(alpha2)*cos(alpha3)*sin(alpha1)^2 + 24*d2*d3^2*d4*cos(alpha2)*cos(alpha3)*sin(alpha1)^2 + 16*a1^2*d3*d4*cos(alpha1)^2*cos(alpha2)^2*cos(alpha3) + 48*a2*a3*d2*d4*sin(alpha1)^2*sin(alpha2)*sin(alpha3);
d = 8*a3*d2^3*sin(alpha1)^2*sin(alpha2) + 8*a3^3*d2*sin(alpha1)^2*sin(alpha2) + 8*a2*d4^3*sin(alpha1)^2*sin(alpha3) + 8*a2^3*d4*sin(alpha1)^2*sin(alpha3) - 16*a1^2*a3*z*cos(alpha1)*sin(alpha2) - 8*a3*d2*r*sin(alpha1)^2*sin(alpha2) - 8*a2*d4*r*sin(alpha1)^2*sin(alpha3) + 16*a1^2*a3*d2*cos(alpha1)^2*sin(alpha2) + 8*a1^2*a3*d2*sin(alpha1)^2*sin(alpha2) + 16*a2*a3^2*d2*sin(alpha1)^2*sin(alpha2) + 8*a2^2*a3*d2*sin(alpha1)^2*sin(alpha2) - 8*a1^2*a2*d4*sin(alpha1)^2*sin(alpha3) - 16*a1^2*a3*d4*sin(alpha1)^2*sin(alpha3) + 8*a2*a3^2*d4*sin(alpha1)^2*sin(alpha3) + 16*a2^2*a3*d4*sin(alpha1)^2*sin(alpha3) + 8*a3*d2*d3^2*sin(alpha1)^2*sin(alpha2) + 8*a2*d2^2*d4*sin(alpha1)^2*sin(alpha3) + 8*a3*d2*d4^2*sin(alpha1)^2*sin(alpha2) + 8*a2*d3^2*d4*sin(alpha1)^2*sin(alpha3) - 16*a1^2*a3*d4*cos(alpha1)^2*sin(alpha2)^2*sin(alpha3) + 16*a1^2*a3*d4*cos(alpha2)^2*sin(alpha1)^2*sin(alpha3) - 16*a2*d2*d4^2*sin(alpha1)^2*sin(alpha2)*sin(alpha3)^2 - 16*a3*d2^2*d4*sin(alpha1)^2*sin(alpha2)^2*sin(alpha3) + 16*a1^2*a3*d3*cos(alpha1)^2*cos(alpha2)*sin(alpha2) + 16*a1^2*a3*d3*cos(alpha2)*sin(alpha1)^2*sin(alpha2) + 16*a3*d2^2*d3*cos(alpha2)*sin(alpha1)^2*sin(alpha2) + 16*a2*d3*d4^2*cos(alpha3)*sin(alpha1)^2*sin(alpha3) + 16*a1^2*a3*d4*cos(alpha1)^2*cos(alpha2)*cos(alpha3)*sin(alpha2) + 16*a1^2*a3*d4*cos(alpha2)*cos(alpha3)*sin(alpha1)^2*sin(alpha2) + 16*a2*d2*d4^2*cos(alpha2)*cos(alpha3)*sin(alpha1)^2*sin(alpha3) + 16*a3*d2^2*d4*cos(alpha2)*cos(alpha3)*sin(alpha1)^2*sin(alpha2) + 16*a2*d2*d3*d4*cos(alpha2)*sin(alpha1)^2*sin(alpha3) + 16*a3*d2*d3*d4*cos(alpha3)*sin(alpha1)^2*sin(alpha2);
e = a1^4*sin(alpha1)^2 + a2^4*sin(alpha1)^2 + a3^4*sin(alpha1)^2 + d2^4*sin(alpha1)^2 + d3^4*sin(alpha1)^2 + d4^4*sin(alpha1)^2 + r^2*sin(alpha1)^2 + 4*a1^2*z^2 + 4*a1^2*d2^2*cos(alpha1)^2 - 2*a1^2*a2^2*sin(alpha1)^2 - 2*a1^2*a3^2*sin(alpha1)^2 + 6*a2^2*a3^2*sin(alpha1)^2 + 2*a1^2*d2^2*sin(alpha1)^2 + 2*a1^2*d3^2*sin(alpha1)^2 + 2*a2^2*d2^2*sin(alpha1)^2 + 2*a1^2*d4^2*sin(alpha1)^2 + 2*a2^2*d3^2*sin(alpha1)^2 + 2*a3^2*d2^2*sin(alpha1)^2 + 2*a2^2*d4^2*sin(alpha1)^2 + 2*a3^2*d3^2*sin(alpha1)^2 + 2*a3^2*d4^2*sin(alpha1)^2 + 2*d2^2*d3^2*sin(alpha1)^2 + 2*d2^2*d4^2*sin(alpha1)^2 + 2*d3^2*d4^2*sin(alpha1)^2 + 4*a2*a3^3*sin(alpha1)^2 + 4*a2^3*a3*sin(alpha1)^2 - 2*a1^2*r*sin(alpha1)^2 - 2*a2^2*r*sin(alpha1)^2 - 2*a3^2*r*sin(alpha1)^2 - 2*d2^2*r*sin(alpha1)^2 - 2*d3^2*r*sin(alpha1)^2 - 2*d4^2*r*sin(alpha1)^2 - 4*a1^2*a2*a3*sin(alpha1)^2 + 4*a2*a3*d2^2*sin(alpha1)^2 + 4*a2*a3*d3^2*sin(alpha1)^2 + 4*a2*a3*d4^2*sin(alpha1)^2 + 4*a1^2*d3^2*cos(alpha1)^2*cos(alpha2)^2 + 4*d2^2*d3^2*cos(alpha2)^2*sin(alpha1)^2 + 4*d3^2*d4^2*cos(alpha3)^2*sin(alpha1)^2 - 4*a1^2*d3^2*sin(alpha1)^2*sin(alpha2)^2 + 4*d2*d3^3*cos(alpha2)*sin(alpha1)^2 + 4*d2^3*d3*cos(alpha2)*sin(alpha1)^2 + 4*d3*d4^3*cos(alpha3)*sin(alpha1)^2 + 4*d3^3*d4*cos(alpha3)*sin(alpha1)^2 - 8*a1^2*d2*z*cos(alpha1) - 4*a2*a3*r*sin(alpha1)^2 + 4*d2*d4^3*cos(alpha2)*cos(alpha3)*sin(alpha1)^2 + 4*d2^3*d4*cos(alpha2)*cos(alpha3)*sin(alpha1)^2 + 4*a1^2*d4^2*cos(alpha1)^2*cos(alpha2)^2*cos(alpha3)^2 + 4*d2^2*d4^2*cos(alpha2)^2*cos(alpha3)^2*sin(alpha1)^2 - 4*d2*d4^3*sin(alpha1)^2*sin(alpha2)*sin(alpha3) - 4*d2^3*d4*sin(alpha1)^2*sin(alpha2)*sin(alpha3) + 4*a1^2*d4^2*cos(alpha1)^2*sin(alpha2)^2*sin(alpha3)^2 - 4*a1^2*d4^2*cos(alpha2)^2*sin(alpha1)^2*sin(alpha3)^2 - 4*a1^2*d4^2*cos(alpha3)^2*sin(alpha1)^2*sin(alpha2)^2 + 4*d2^2*d4^2*sin(alpha1)^2*sin(alpha2)^2*sin(alpha3)^2 - 8*a1^2*d3*z*cos(alpha1)*cos(alpha2) - 4*d2*d3*r*cos(alpha2)*sin(alpha1)^2 - 4*d3*d4*r*cos(alpha3)*sin(alpha1)^2 + 8*a1^2*d2*d3*cos(alpha1)^2*cos(alpha2) + 4*a1^2*d2*d3*cos(alpha2)*sin(alpha1)^2 + 4*a2^2*d2*d3*cos(alpha2)*sin(alpha1)^2 + 4*a3^2*d2*d3*cos(alpha2)*sin(alpha1)^2 + 4*a1^2*d3*d4*cos(alpha3)*sin(alpha1)^2 + 4*a2^2*d3*d4*cos(alpha3)*sin(alpha1)^2 + 4*a3^2*d3*d4*cos(alpha3)*sin(alpha1)^2 + 4*d2*d3*d4^2*cos(alpha2)*sin(alpha1)^2 + 4*d2^2*d3*d4*cos(alpha3)*sin(alpha1)^2 + 8*d2*d3*d4^2*cos(alpha2)*cos(alpha3)^2*sin(alpha1)^2 + 8*d2^2*d3*d4*cos(alpha2)^2*cos(alpha3)*sin(alpha1)^2 - 8*a1^2*d3*d4*cos(alpha3)*sin(alpha1)^2*sin(alpha2)^2 - 8*a1^2*d4*z*cos(alpha1)*cos(alpha2)*cos(alpha3) - 4*d2*d4*r*cos(alpha2)*cos(alpha3)*sin(alpha1)^2 + 8*a1^2*d4*z*cos(alpha1)*sin(alpha2)*sin(alpha3) + 4*d2*d4*r*sin(alpha1)^2*sin(alpha2)*sin(alpha3) + 8*a1^2*d2*d4*cos(alpha1)^2*cos(alpha2)*cos(alpha3) + 4*a1^2*d2*d4*cos(alpha2)*cos(alpha3)*sin(alpha1)^2 + 4*a2^2*d2*d4*cos(alpha2)*cos(alpha3)*sin(alpha1)^2 + 4*a3^2*d2*d4*cos(alpha2)*cos(alpha3)*sin(alpha1)^2 + 12*d2*d3^2*d4*cos(alpha2)*cos(alpha3)*sin(alpha1)^2 - 8*a1^2*d2*d4*cos(alpha1)^2*sin(alpha2)*sin(alpha3) - 4*a1^2*d2*d4*sin(alpha1)^2*sin(alpha2)*sin(alpha3) - 4*a2^2*d2*d4*sin(alpha1)^2*sin(alpha2)*sin(alpha3) - 4*a3^2*d2*d4*sin(alpha1)^2*sin(alpha2)*sin(alpha3) - 4*d2*d3^2*d4*sin(alpha1)^2*sin(alpha2)*sin(alpha3) + 8*a2*a3*d2*d3*cos(alpha2)*sin(alpha1)^2 + 8*a2*a3*d3*d4*cos(alpha3)*sin(alpha1)^2 + 8*a1^2*d3*d4*cos(alpha1)^2*cos(alpha2)^2*cos(alpha3) - 8*a1^2*d4^2*cos(alpha1)^2*cos(alpha2)*cos(alpha3)*sin(alpha2)*sin(alpha3) - 8*a1^2*d4^2*cos(alpha2)*cos(alpha3)*sin(alpha1)^2*sin(alpha2)*sin(alpha3) - 8*d2^2*d4^2*cos(alpha2)*cos(alpha3)*sin(alpha1)^2*sin(alpha2)*sin(alpha3) - 8*a1^2*d3*d4*cos(alpha1)^2*cos(alpha2)*sin(alpha2)*sin(alpha3) - 8*a1^2*d3*d4*cos(alpha2)*sin(alpha1)^2*sin(alpha2)*sin(alpha3) - 8*d2^2*d3*d4*cos(alpha2)*sin(alpha1)^2*sin(alpha2)*sin(alpha3) - 8*d2*d3*d4^2*cos(alpha3)*sin(alpha1)^2*sin(alpha2)*sin(alpha3) + 8*a2*a3*d2*d4*cos(alpha2)*cos(alpha3)*sin(alpha1)^2 - 8*a2*a3*d2*d4*sin(alpha1)^2*sin(alpha2)*sin(alpha3);

% after adding d1 to k4
% a = a1^4*sin(alpha1)^2 + a2^4*sin(alpha1)^2 + a3^4*sin(alpha1)^2 + d2^4*sin(alpha1)^2 + d3^4*sin(alpha1)^2 + d4^4*sin(alpha1)^2 + r^2*sin(alpha1)^2 + 4*a1^2*d1^2 + 4*a1^2*z^2 + 4*a1^2*d2^2*cos(alpha1)^2 - 2*a1^2*a2^2*sin(alpha1)^2 - 2*a1^2*a3^2*sin(alpha1)^2 + 6*a2^2*a3^2*sin(alpha1)^2 + 2*a1^2*d2^2*sin(alpha1)^2 + 2*a1^2*d3^2*sin(alpha1)^2 + 2*a2^2*d2^2*sin(alpha1)^2 + 2*a1^2*d4^2*sin(alpha1)^2 + 2*a2^2*d3^2*sin(alpha1)^2 + 2*a3^2*d2^2*sin(alpha1)^2 + 2*a2^2*d4^2*sin(alpha1)^2 + 2*a3^2*d3^2*sin(alpha1)^2 + 2*a3^2*d4^2*sin(alpha1)^2 + 2*d2^2*d3^2*sin(alpha1)^2 + 2*d2^2*d4^2*sin(alpha1)^2 + 2*d3^2*d4^2*sin(alpha1)^2 + 4*a2*a3^3*sin(alpha1)^2 + 4*a2^3*a3*sin(alpha1)^2 - 2*a1^2*r*sin(alpha1)^2 - 2*a2^2*r*sin(alpha1)^2 - 2*a3^2*r*sin(alpha1)^2 - 2*d2^2*r*sin(alpha1)^2 - 2*d3^2*r*sin(alpha1)^2 - 2*d4^2*r*sin(alpha1)^2 - 8*a1^2*d1*z - 4*a1^2*a2*a3*sin(alpha1)^2 + 4*a2*a3*d2^2*sin(alpha1)^2 + 4*a2*a3*d3^2*sin(alpha1)^2 + 4*a2*a3*d4^2*sin(alpha1)^2 + 4*a1^2*d3^2*cos(alpha1)^2*cos(alpha2)^2 + 4*d2^2*d3^2*cos(alpha2)^2*sin(alpha1)^2 + 4*d3^2*d4^2*cos(alpha3)^2*sin(alpha1)^2 - 4*a1^2*d3^2*sin(alpha1)^2*sin(alpha2)^2 + 4*d2*d3^3*cos(alpha2)*sin(alpha1)^2 + 4*d2^3*d3*cos(alpha2)*sin(alpha1)^2 + 4*d3*d4^3*cos(alpha3)*sin(alpha1)^2 + 4*d3^3*d4*cos(alpha3)*sin(alpha1)^2 + 8*a1^2*d1*d2*cos(alpha1) - 8*a1^2*d2*z*cos(alpha1) - 4*a2*a3*r*sin(alpha1)^2 + 4*d2*d4^3*cos(alpha2)*cos(alpha3)*sin(alpha1)^2 + 4*d2^3*d4*cos(alpha2)*cos(alpha3)*sin(alpha1)^2 + 4*a1^2*d4^2*cos(alpha1)^2*cos(alpha2)^2*cos(alpha3)^2 + 4*d2^2*d4^2*cos(alpha2)^2*cos(alpha3)^2*sin(alpha1)^2 - 4*d2*d4^3*sin(alpha1)^2*sin(alpha2)*sin(alpha3) - 4*d2^3*d4*sin(alpha1)^2*sin(alpha2)*sin(alpha3) + 4*a1^2*d4^2*cos(alpha1)^2*sin(alpha2)^2*sin(alpha3)^2 - 4*a1^2*d4^2*cos(alpha2)^2*sin(alpha1)^2*sin(alpha3)^2 - 4*a1^2*d4^2*cos(alpha3)^2*sin(alpha1)^2*sin(alpha2)^2 + 8*a1^2*d1*d3*cos(alpha1)*cos(alpha2) + 4*d2^2*d4^2*sin(alpha1)^2*sin(alpha2)^2*sin(alpha3)^2 - 8*a1^2*d3*z*cos(alpha1)*cos(alpha2) - 4*d2*d3*r*cos(alpha2)*sin(alpha1)^2 - 4*d3*d4*r*cos(alpha3)*sin(alpha1)^2 + 8*a1^2*d2*d3*cos(alpha1)^2*cos(alpha2) + 4*a1^2*d2*d3*cos(alpha2)*sin(alpha1)^2 + 4*a2^2*d2*d3*cos(alpha2)*sin(alpha1)^2 + 4*a3^2*d2*d3*cos(alpha2)*sin(alpha1)^2 + 4*a1^2*d3*d4*cos(alpha3)*sin(alpha1)^2 + 4*a2^2*d3*d4*cos(alpha3)*sin(alpha1)^2 + 4*a3^2*d3*d4*cos(alpha3)*sin(alpha1)^2 + 4*d2*d3*d4^2*cos(alpha2)*sin(alpha1)^2 + 4*d2^2*d3*d4*cos(alpha3)*sin(alpha1)^2 + 8*d2*d3*d4^2*cos(alpha2)*cos(alpha3)^2*sin(alpha1)^2 + 8*d2^2*d3*d4*cos(alpha2)^2*cos(alpha3)*sin(alpha1)^2 - 8*a1^2*d3*d4*cos(alpha3)*sin(alpha1)^2*sin(alpha2)^2 + 8*a1^2*d1*d4*cos(alpha1)*cos(alpha2)*cos(alpha3) - 8*a1^2*d4*z*cos(alpha1)*cos(alpha2)*cos(alpha3) - 8*a1^2*d1*d4*cos(alpha1)*sin(alpha2)*sin(alpha3) - 4*d2*d4*r*cos(alpha2)*cos(alpha3)*sin(alpha1)^2 + 8*a1^2*d4*z*cos(alpha1)*sin(alpha2)*sin(alpha3) + 4*d2*d4*r*sin(alpha1)^2*sin(alpha2)*sin(alpha3) + 8*a1^2*d2*d4*cos(alpha1)^2*cos(alpha2)*cos(alpha3) + 4*a1^2*d2*d4*cos(alpha2)*cos(alpha3)*sin(alpha1)^2 + 4*a2^2*d2*d4*cos(alpha2)*cos(alpha3)*sin(alpha1)^2 + 4*a3^2*d2*d4*cos(alpha2)*cos(alpha3)*sin(alpha1)^2 + 12*d2*d3^2*d4*cos(alpha2)*cos(alpha3)*sin(alpha1)^2 - 8*a1^2*d2*d4*cos(alpha1)^2*sin(alpha2)*sin(alpha3) - 4*a1^2*d2*d4*sin(alpha1)^2*sin(alpha2)*sin(alpha3) - 4*a2^2*d2*d4*sin(alpha1)^2*sin(alpha2)*sin(alpha3) - 4*a3^2*d2*d4*sin(alpha1)^2*sin(alpha2)*sin(alpha3) - 4*d2*d3^2*d4*sin(alpha1)^2*sin(alpha2)*sin(alpha3) + 8*a2*a3*d2*d3*cos(alpha2)*sin(alpha1)^2 + 8*a2*a3*d3*d4*cos(alpha3)*sin(alpha1)^2 + 8*a1^2*d3*d4*cos(alpha1)^2*cos(alpha2)^2*cos(alpha3) - 8*a1^2*d4^2*cos(alpha1)^2*cos(alpha2)*cos(alpha3)*sin(alpha2)*sin(alpha3) - 8*a1^2*d4^2*cos(alpha2)*cos(alpha3)*sin(alpha1)^2*sin(alpha2)*sin(alpha3) - 8*d2^2*d4^2*cos(alpha2)*cos(alpha3)*sin(alpha1)^2*sin(alpha2)*sin(alpha3) - 8*a1^2*d3*d4*cos(alpha1)^2*cos(alpha2)*sin(alpha2)*sin(alpha3) - 8*a1^2*d3*d4*cos(alpha2)*sin(alpha1)^2*sin(alpha2)*sin(alpha3) - 8*d2^2*d3*d4*cos(alpha2)*sin(alpha1)^2*sin(alpha2)*sin(alpha3) - 8*d2*d3*d4^2*cos(alpha3)*sin(alpha1)^2*sin(alpha2)*sin(alpha3) + 8*a2*a3*d2*d4*cos(alpha2)*cos(alpha3)*sin(alpha1)^2 - 8*a2*a3*d2*d4*sin(alpha1)^2*sin(alpha2)*sin(alpha3);
% b = 8*a3*d2^3*sin(alpha1)^2*sin(alpha2) + 8*a3^3*d2*sin(alpha1)^2*sin(alpha2) + 8*a2*d4^3*sin(alpha1)^2*sin(alpha3) + 8*a2^3*d4*sin(alpha1)^2*sin(alpha3) + 16*a1^2*a3*d1*cos(alpha1)*sin(alpha2) - 16*a1^2*a3*z*cos(alpha1)*sin(alpha2) - 8*a3*d2*r*sin(alpha1)^2*sin(alpha2) - 8*a2*d4*r*sin(alpha1)^2*sin(alpha3) + 16*a1^2*a3*d2*cos(alpha1)^2*sin(alpha2) + 8*a1^2*a3*d2*sin(alpha1)^2*sin(alpha2) + 16*a2*a3^2*d2*sin(alpha1)^2*sin(alpha2) + 8*a2^2*a3*d2*sin(alpha1)^2*sin(alpha2) - 8*a1^2*a2*d4*sin(alpha1)^2*sin(alpha3) - 16*a1^2*a3*d4*sin(alpha1)^2*sin(alpha3) + 8*a2*a3^2*d4*sin(alpha1)^2*sin(alpha3) + 16*a2^2*a3*d4*sin(alpha1)^2*sin(alpha3) + 8*a3*d2*d3^2*sin(alpha1)^2*sin(alpha2) + 8*a2*d2^2*d4*sin(alpha1)^2*sin(alpha3) + 8*a3*d2*d4^2*sin(alpha1)^2*sin(alpha2) + 8*a2*d3^2*d4*sin(alpha1)^2*sin(alpha3) - 16*a1^2*a3*d4*cos(alpha1)^2*sin(alpha2)^2*sin(alpha3) + 16*a1^2*a3*d4*cos(alpha2)^2*sin(alpha1)^2*sin(alpha3) - 16*a2*d2*d4^2*sin(alpha1)^2*sin(alpha2)*sin(alpha3)^2 - 16*a3*d2^2*d4*sin(alpha1)^2*sin(alpha2)^2*sin(alpha3) + 16*a1^2*a3*d3*cos(alpha1)^2*cos(alpha2)*sin(alpha2) + 16*a1^2*a3*d3*cos(alpha2)*sin(alpha1)^2*sin(alpha2) + 16*a3*d2^2*d3*cos(alpha2)*sin(alpha1)^2*sin(alpha2) + 16*a2*d3*d4^2*cos(alpha3)*sin(alpha1)^2*sin(alpha3) + 16*a1^2*a3*d4*cos(alpha1)^2*cos(alpha2)*cos(alpha3)*sin(alpha2) + 16*a1^2*a3*d4*cos(alpha2)*cos(alpha3)*sin(alpha1)^2*sin(alpha2) + 16*a2*d2*d4^2*cos(alpha2)*cos(alpha3)*sin(alpha1)^2*sin(alpha3) + 16*a3*d2^2*d4*cos(alpha2)*cos(alpha3)*sin(alpha1)^2*sin(alpha2) + 16*a2*d2*d3*d4*cos(alpha2)*sin(alpha1)^2*sin(alpha3) + 16*a3*d2*d3*d4*cos(alpha3)*sin(alpha1)^2*sin(alpha2);
% c = 2*a1^4*sin(alpha1)^2 + 2*a2^4*sin(alpha1)^2 + 2*a3^4*sin(alpha1)^2 + 2*d2^4*sin(alpha1)^2 + 2*d3^4*sin(alpha1)^2 + 2*d4^4*sin(alpha1)^2 + 2*r^2*sin(alpha1)^2 + 8*a1^2*d1^2 + 8*a1^2*z^2 + 8*a1^2*d2^2*cos(alpha1)^2 - 4*a1^2*a2^2*sin(alpha1)^2 + 12*a1^2*a3^2*sin(alpha1)^2 - 4*a2^2*a3^2*sin(alpha1)^2 + 4*a1^2*d2^2*sin(alpha1)^2 + 4*a1^2*d3^2*sin(alpha1)^2 + 4*a2^2*d2^2*sin(alpha1)^2 + 4*a1^2*d4^2*sin(alpha1)^2 + 4*a2^2*d3^2*sin(alpha1)^2 + 4*a3^2*d2^2*sin(alpha1)^2 + 4*a2^2*d4^2*sin(alpha1)^2 + 4*a3^2*d3^2*sin(alpha1)^2 + 4*a3^2*d4^2*sin(alpha1)^2 + 4*d2^2*d3^2*sin(alpha1)^2 + 4*d2^2*d4^2*sin(alpha1)^2 + 4*d3^2*d4^2*sin(alpha1)^2 - 4*a1^2*r*sin(alpha1)^2 - 4*a2^2*r*sin(alpha1)^2 - 4*a3^2*r*sin(alpha1)^2 - 4*d2^2*r*sin(alpha1)^2 - 4*d3^2*r*sin(alpha1)^2 - 4*d4^2*r*sin(alpha1)^2 - 16*a1^2*d1*z + 8*a1^2*d3^2*cos(alpha1)^2*cos(alpha2)^2 + 16*a1^2*a3^2*cos(alpha1)^2*sin(alpha2)^2 - 16*a1^2*a3^2*cos(alpha2)^2*sin(alpha1)^2 + 8*d2^2*d3^2*cos(alpha2)^2*sin(alpha1)^2 + 8*d3^2*d4^2*cos(alpha3)^2*sin(alpha1)^2 - 8*a1^2*d3^2*sin(alpha1)^2*sin(alpha2)^2 + 16*a3^2*d2^2*sin(alpha1)^2*sin(alpha2)^2 - 16*a1^2*d4^2*sin(alpha1)^2*sin(alpha3)^2 + 16*a2^2*d4^2*sin(alpha1)^2*sin(alpha3)^2 + 8*d2*d3^3*cos(alpha2)*sin(alpha1)^2 + 8*d2^3*d3*cos(alpha2)*sin(alpha1)^2 + 8*d3*d4^3*cos(alpha3)*sin(alpha1)^2 + 8*d3^3*d4*cos(alpha3)*sin(alpha1)^2 + 16*a1^2*d1*d2*cos(alpha1) - 16*a1^2*d2*z*cos(alpha1) + 8*d2*d4^3*cos(alpha2)*cos(alpha3)*sin(alpha1)^2 + 8*d2^3*d4*cos(alpha2)*cos(alpha3)*sin(alpha1)^2 + 8*a1^2*d4^2*cos(alpha1)^2*cos(alpha2)^2*cos(alpha3)^2 + 8*d2^2*d4^2*cos(alpha2)^2*cos(alpha3)^2*sin(alpha1)^2 - 8*a1^2*d4^2*cos(alpha1)^2*sin(alpha2)^2*sin(alpha3)^2 + 8*a1^2*d4^2*cos(alpha2)^2*sin(alpha1)^2*sin(alpha3)^2 - 8*a1^2*d4^2*cos(alpha3)^2*sin(alpha1)^2*sin(alpha2)^2 + 16*a1^2*d1*d3*cos(alpha1)*cos(alpha2) - 8*d2^2*d4^2*sin(alpha1)^2*sin(alpha2)^2*sin(alpha3)^2 - 16*a1^2*d3*z*cos(alpha1)*cos(alpha2) - 8*d2*d3*r*cos(alpha2)*sin(alpha1)^2 - 8*d3*d4*r*cos(alpha3)*sin(alpha1)^2 + 16*a1^2*d2*d3*cos(alpha1)^2*cos(alpha2) + 8*a1^2*d2*d3*cos(alpha2)*sin(alpha1)^2 + 8*a2^2*d2*d3*cos(alpha2)*sin(alpha1)^2 + 8*a3^2*d2*d3*cos(alpha2)*sin(alpha1)^2 + 8*a1^2*d3*d4*cos(alpha3)*sin(alpha1)^2 + 8*a2^2*d3*d4*cos(alpha3)*sin(alpha1)^2 + 8*a3^2*d3*d4*cos(alpha3)*sin(alpha1)^2 + 8*d2*d3*d4^2*cos(alpha2)*sin(alpha1)^2 + 8*d2^2*d3*d4*cos(alpha3)*sin(alpha1)^2 + 16*d2*d3*d4^2*cos(alpha2)*cos(alpha3)^2*sin(alpha1)^2 + 16*d2^2*d3*d4*cos(alpha2)^2*cos(alpha3)*sin(alpha1)^2 - 16*a1^2*d3*d4*cos(alpha3)*sin(alpha1)^2*sin(alpha2)^2 + 16*a1^2*d1*d4*cos(alpha1)*cos(alpha2)*cos(alpha3) - 16*a1^2*d4*z*cos(alpha1)*cos(alpha2)*cos(alpha3) - 8*d2*d4*r*cos(alpha2)*cos(alpha3)*sin(alpha1)^2 + 16*a1^2*d2*d4*cos(alpha1)^2*cos(alpha2)*cos(alpha3) + 8*a1^2*d2*d4*cos(alpha2)*cos(alpha3)*sin(alpha1)^2 + 8*a2^2*d2*d4*cos(alpha2)*cos(alpha3)*sin(alpha1)^2 + 8*a3^2*d2*d4*cos(alpha2)*cos(alpha3)*sin(alpha1)^2 + 24*d2*d3^2*d4*cos(alpha2)*cos(alpha3)*sin(alpha1)^2 + 16*a1^2*d3*d4*cos(alpha1)^2*cos(alpha2)^2*cos(alpha3) + 48*a2*a3*d2*d4*sin(alpha1)^2*sin(alpha2)*sin(alpha3);
% d = 8*a3*d2^3*sin(alpha1)^2*sin(alpha2) + 8*a3^3*d2*sin(alpha1)^2*sin(alpha2) + 8*a2*d4^3*sin(alpha1)^2*sin(alpha3) + 8*a2^3*d4*sin(alpha1)^2*sin(alpha3) + 16*a1^2*a3*d1*cos(alpha1)*sin(alpha2) - 16*a1^2*a3*z*cos(alpha1)*sin(alpha2) - 8*a3*d2*r*sin(alpha1)^2*sin(alpha2) - 8*a2*d4*r*sin(alpha1)^2*sin(alpha3) + 16*a1^2*a3*d2*cos(alpha1)^2*sin(alpha2) + 8*a1^2*a3*d2*sin(alpha1)^2*sin(alpha2) - 16*a2*a3^2*d2*sin(alpha1)^2*sin(alpha2) + 8*a2^2*a3*d2*sin(alpha1)^2*sin(alpha2) - 8*a1^2*a2*d4*sin(alpha1)^2*sin(alpha3) + 16*a1^2*a3*d4*sin(alpha1)^2*sin(alpha3) + 8*a2*a3^2*d4*sin(alpha1)^2*sin(alpha3) - 16*a2^2*a3*d4*sin(alpha1)^2*sin(alpha3) + 8*a3*d2*d3^2*sin(alpha1)^2*sin(alpha2) + 8*a2*d2^2*d4*sin(alpha1)^2*sin(alpha3) + 8*a3*d2*d4^2*sin(alpha1)^2*sin(alpha2) + 8*a2*d3^2*d4*sin(alpha1)^2*sin(alpha3) + 16*a1^2*a3*d4*cos(alpha1)^2*sin(alpha2)^2*sin(alpha3) - 16*a1^2*a3*d4*cos(alpha2)^2*sin(alpha1)^2*sin(alpha3) + 16*a2*d2*d4^2*sin(alpha1)^2*sin(alpha2)*sin(alpha3)^2 + 16*a3*d2^2*d4*sin(alpha1)^2*sin(alpha2)^2*sin(alpha3) + 16*a1^2*a3*d3*cos(alpha1)^2*cos(alpha2)*sin(alpha2) + 16*a1^2*a3*d3*cos(alpha2)*sin(alpha1)^2*sin(alpha2) + 16*a3*d2^2*d3*cos(alpha2)*sin(alpha1)^2*sin(alpha2) + 16*a2*d3*d4^2*cos(alpha3)*sin(alpha1)^2*sin(alpha3) + 16*a1^2*a3*d4*cos(alpha1)^2*cos(alpha2)*cos(alpha3)*sin(alpha2) + 16*a1^2*a3*d4*cos(alpha2)*cos(alpha3)*sin(alpha1)^2*sin(alpha2) + 16*a2*d2*d4^2*cos(alpha2)*cos(alpha3)*sin(alpha1)^2*sin(alpha3) + 16*a3*d2^2*d4*cos(alpha2)*cos(alpha3)*sin(alpha1)^2*sin(alpha2) + 16*a2*d2*d3*d4*cos(alpha2)*sin(alpha1)^2*sin(alpha3) + 16*a3*d2*d3*d4*cos(alpha3)*sin(alpha1)^2*sin(alpha2);
% e = a1^4*sin(alpha1)^2 + a2^4*sin(alpha1)^2 + a3^4*sin(alpha1)^2 + d2^4*sin(alpha1)^2 + d3^4*sin(alpha1)^2 + d4^4*sin(alpha1)^2 + r^2*sin(alpha1)^2 + 4*a1^2*d1^2 + 4*a1^2*z^2 + 4*a1^2*d2^2*cos(alpha1)^2 - 2*a1^2*a2^2*sin(alpha1)^2 - 2*a1^2*a3^2*sin(alpha1)^2 + 6*a2^2*a3^2*sin(alpha1)^2 + 2*a1^2*d2^2*sin(alpha1)^2 + 2*a1^2*d3^2*sin(alpha1)^2 + 2*a2^2*d2^2*sin(alpha1)^2 + 2*a1^2*d4^2*sin(alpha1)^2 + 2*a2^2*d3^2*sin(alpha1)^2 + 2*a3^2*d2^2*sin(alpha1)^2 + 2*a2^2*d4^2*sin(alpha1)^2 + 2*a3^2*d3^2*sin(alpha1)^2 + 2*a3^2*d4^2*sin(alpha1)^2 + 2*d2^2*d3^2*sin(alpha1)^2 + 2*d2^2*d4^2*sin(alpha1)^2 + 2*d3^2*d4^2*sin(alpha1)^2 - 4*a2*a3^3*sin(alpha1)^2 - 4*a2^3*a3*sin(alpha1)^2 - 2*a1^2*r*sin(alpha1)^2 - 2*a2^2*r*sin(alpha1)^2 - 2*a3^2*r*sin(alpha1)^2 - 2*d2^2*r*sin(alpha1)^2 - 2*d3^2*r*sin(alpha1)^2 - 2*d4^2*r*sin(alpha1)^2 - 8*a1^2*d1*z + 4*a1^2*a2*a3*sin(alpha1)^2 - 4*a2*a3*d2^2*sin(alpha1)^2 - 4*a2*a3*d3^2*sin(alpha1)^2 - 4*a2*a3*d4^2*sin(alpha1)^2 + 4*a1^2*d3^2*cos(alpha1)^2*cos(alpha2)^2 + 4*d2^2*d3^2*cos(alpha2)^2*sin(alpha1)^2 + 4*d3^2*d4^2*cos(alpha3)^2*sin(alpha1)^2 - 4*a1^2*d3^2*sin(alpha1)^2*sin(alpha2)^2 + 4*d2*d3^3*cos(alpha2)*sin(alpha1)^2 + 4*d2^3*d3*cos(alpha2)*sin(alpha1)^2 + 4*d3*d4^3*cos(alpha3)*sin(alpha1)^2 + 4*d3^3*d4*cos(alpha3)*sin(alpha1)^2 + 8*a1^2*d1*d2*cos(alpha1) - 8*a1^2*d2*z*cos(alpha1) + 4*a2*a3*r*sin(alpha1)^2 + 4*d2*d4^3*cos(alpha2)*cos(alpha3)*sin(alpha1)^2 + 4*d2^3*d4*cos(alpha2)*cos(alpha3)*sin(alpha1)^2 + 4*a1^2*d4^2*cos(alpha1)^2*cos(alpha2)^2*cos(alpha3)^2 + 4*d2^2*d4^2*cos(alpha2)^2*cos(alpha3)^2*sin(alpha1)^2 + 4*d2*d4^3*sin(alpha1)^2*sin(alpha2)*sin(alpha3) + 4*d2^3*d4*sin(alpha1)^2*sin(alpha2)*sin(alpha3) + 4*a1^2*d4^2*cos(alpha1)^2*sin(alpha2)^2*sin(alpha3)^2 - 4*a1^2*d4^2*cos(alpha2)^2*sin(alpha1)^2*sin(alpha3)^2 - 4*a1^2*d4^2*cos(alpha3)^2*sin(alpha1)^2*sin(alpha2)^2 + 8*a1^2*d1*d3*cos(alpha1)*cos(alpha2) + 4*d2^2*d4^2*sin(alpha1)^2*sin(alpha2)^2*sin(alpha3)^2 - 8*a1^2*d3*z*cos(alpha1)*cos(alpha2) - 4*d2*d3*r*cos(alpha2)*sin(alpha1)^2 - 4*d3*d4*r*cos(alpha3)*sin(alpha1)^2 + 8*a1^2*d2*d3*cos(alpha1)^2*cos(alpha2) + 4*a1^2*d2*d3*cos(alpha2)*sin(alpha1)^2 + 4*a2^2*d2*d3*cos(alpha2)*sin(alpha1)^2 + 4*a3^2*d2*d3*cos(alpha2)*sin(alpha1)^2 + 4*a1^2*d3*d4*cos(alpha3)*sin(alpha1)^2 + 4*a2^2*d3*d4*cos(alpha3)*sin(alpha1)^2 + 4*a3^2*d3*d4*cos(alpha3)*sin(alpha1)^2 + 4*d2*d3*d4^2*cos(alpha2)*sin(alpha1)^2 + 4*d2^2*d3*d4*cos(alpha3)*sin(alpha1)^2 + 8*d2*d3*d4^2*cos(alpha2)*cos(alpha3)^2*sin(alpha1)^2 + 8*d2^2*d3*d4*cos(alpha2)^2*cos(alpha3)*sin(alpha1)^2 - 8*a1^2*d3*d4*cos(alpha3)*sin(alpha1)^2*sin(alpha2)^2 + 8*a1^2*d1*d4*cos(alpha1)*cos(alpha2)*cos(alpha3) - 8*a1^2*d4*z*cos(alpha1)*cos(alpha2)*cos(alpha3) + 8*a1^2*d1*d4*cos(alpha1)*sin(alpha2)*sin(alpha3) - 4*d2*d4*r*cos(alpha2)*cos(alpha3)*sin(alpha1)^2 - 8*a1^2*d4*z*cos(alpha1)*sin(alpha2)*sin(alpha3) - 4*d2*d4*r*sin(alpha1)^2*sin(alpha2)*sin(alpha3) + 8*a1^2*d2*d4*cos(alpha1)^2*cos(alpha2)*cos(alpha3) + 4*a1^2*d2*d4*cos(alpha2)*cos(alpha3)*sin(alpha1)^2 + 4*a2^2*d2*d4*cos(alpha2)*cos(alpha3)*sin(alpha1)^2 + 4*a3^2*d2*d4*cos(alpha2)*cos(alpha3)*sin(alpha1)^2 + 12*d2*d3^2*d4*cos(alpha2)*cos(alpha3)*sin(alpha1)^2 + 8*a1^2*d2*d4*cos(alpha1)^2*sin(alpha2)*sin(alpha3) + 4*a1^2*d2*d4*sin(alpha1)^2*sin(alpha2)*sin(alpha3) + 4*a2^2*d2*d4*sin(alpha1)^2*sin(alpha2)*sin(alpha3) + 4*a3^2*d2*d4*sin(alpha1)^2*sin(alpha2)*sin(alpha3) + 4*d2*d3^2*d4*sin(alpha1)^2*sin(alpha2)*sin(alpha3) - 8*a2*a3*d2*d3*cos(alpha2)*sin(alpha1)^2 - 8*a2*a3*d3*d4*cos(alpha3)*sin(alpha1)^2 + 8*a1^2*d3*d4*cos(alpha1)^2*cos(alpha2)^2*cos(alpha3) + 8*a1^2*d4^2*cos(alpha1)^2*cos(alpha2)*cos(alpha3)*sin(alpha2)*sin(alpha3) + 8*a1^2*d4^2*cos(alpha2)*cos(alpha3)*sin(alpha1)^2*sin(alpha2)*sin(alpha3) + 8*d2^2*d4^2*cos(alpha2)*cos(alpha3)*sin(alpha1)^2*sin(alpha2)*sin(alpha3) + 8*a1^2*d3*d4*cos(alpha1)^2*cos(alpha2)*sin(alpha2)*sin(alpha3) + 8*a1^2*d3*d4*cos(alpha2)*sin(alpha1)^2*sin(alpha2)*sin(alpha3) + 8*d2^2*d3*d4*cos(alpha2)*sin(alpha1)^2*sin(alpha2)*sin(alpha3) + 8*d2*d3*d4^2*cos(alpha3)*sin(alpha1)^2*sin(alpha2)*sin(alpha3) - 8*a2*a3*d2*d4*cos(alpha2)*cos(alpha3)*sin(alpha1)^2 - 8*a2*a3*d2*d4*sin(alpha1)^2*sin(alpha2)*sin(alpha3);
